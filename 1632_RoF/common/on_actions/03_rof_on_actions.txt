on_actions = {
	#Not run on a specific country.
	on_startup = {
		effect = {
			#WNA = {
			#	add_equipment_to_stockpile = { type = up_time_weapons amount = 1000 producer = WNA }
			#	send_equipment = {
			#		equipment = up_time_weapons
			#		amount = 1000
			#		target = NUS
			#	}
			#}
			every_state = { remove_core_of = WSA remove_core_of = WNA remove_core_of = WAS remove_core_of = WAF remove_core_of = WAU }
			every_country = {
				limit = { is_ai = no }
				country_event = { id = RoF.000 }
				country_event = { id = RoF.030 }
			}
			random_country = {
				limit = { is_ai = yes }
				country_event = { id = RoF.006 }
			}
			set_global_flag = thirty_years_war_ongoing
			every_country = {
				limit = {
					is_in_faction_with = AUS
				}
				TYR = {
					diplomatic_relation = {
						country = PREV
						relation = military_access
					}
				}
			}
			every_country = {
				limit = { is_german_tag = yes }
				add_to_array = { global.german_tags = THIS }
			}
			# RANDOM GAME RULE FLAGS
			NUS = {
				if = {
					limit = {
						has_game_rule = {
							rule = NUS_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { set_country_flag = NUS_AI_RANDOM_CANON }
						35 = { set_country_flag = NUS_AI_RANDOM_RADICAL }
						15 = { set_country_flag = NUS_AI_RANDOM_ABSOLUTIST }
					}
				}
			}
			AUS = {
				if = {
					limit = {
						has_game_rule = {
							rule = AUS_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { set_country_flag = AUS_AI_RANDOM_CANON }
						50 = { set_country_flag = AUS_AI_RANDOM_ALTERNATE }
					}
				}
			}
			FRA = {
				if = {
					limit = {
						has_game_rule = {
							rule = FRA_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { set_country_flag = FRA_AI_RANDOM_CANON }
						50 = { set_country_flag = FRA_AI_RANDOM_CONSTITUTIONALIST }
					}
				}
			}
			ENG = {
				if = {
					limit = {
						has_game_rule = {
							rule = ENG_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { set_country_flag = ENG_AI_RANDOM_CANON }
						50 = { set_country_flag = ENG_AI_RANDOM_CONSTITUTIONALIST }
					}
				}
			}
			POL = {
				if = {
					limit = {
						has_game_rule = {
							rule = POL_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { set_country_flag = POL_AI_RANDOM_CANON }
						30 = { set_country_flag = POL_AI_RANDOM_ABSOLUTIST_ALTERNATE }
						20 = { set_country_flag = POL_AI_RANDOM_CONSTITUTIONALIST }
					}
				}
			}
			SWE = {
				if = {
					limit = {
						has_game_rule = {
							rule = SWE_ai_behavior
							option = RANDOM
						}
					}
					random_list = {
						50 = { set_country_flag = SWE_AI_RANDOM_CANON }
						#30 = { set_country_flag = SWE_AI_RANDOM_ALTERNATE }
					}
				}
			}
		}
	}
	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			if = {
				limit = {
					is_german_tag = yes
					has_war_with = NUS
					FROM = {
						USE_or_war_ally = yes
					}
				}
				country_event = { id = RoF_USE.105 }
			}
			if = {
				limit = {
					has_country_flag = NUS_coc_inspired
				}
				clr_country_flag = NUS_coc_inspired
				set_country_flag = NUS_coc_inspired_capitulated
				add_to_variable = { NUS.NUS_patriotic_fervor = -1 }
				remove_from_array = {
					array = NUS.patriotic_fervor_array
					value = ROOT
				}
			}
			#if = {
			#	limit = {
			#		tag = DEN
			#		is_in_faction_with = FRA
			#		FROM = { OR = { tag = NUS tag = SWE } }
			#	}
				#country_event = { id = RoF_DEN.150 }
			#}
		}
	}
	# ROOT is capitulated country
	on_uncapitulation = {
		effect = {
			if = {
				limit = {
					has_country_flag = NUS_coc_inspired_capitulated
				}
				clr_country_flag = NUS_coc_inspired_capitulated
				set_country_flag = NUS_coc_inspired
				add_to_variable = { NUS.NUS_patriotic_fervor = 1 }
				add_to_array = {
					array = NUS.patriotic_fervor_array
					value = ROOT
				}
			}
		}

	}
	#ROOT is winner #FROM is loser
	on_peaceconference_ended = {
		effect = {
			if = {
				limit = {
					has_global_flag = thirty_years_war_ongoing
					OR = {
						AND = {
							FROM = { tag = SWE }
							OR = {
								tag = AUS
								is_in_faction_with = AUS
							}
						}
						AND = {
							FROM = { tag = AUS }
							OR = {
								tag = SWE
								is_in_faction_with = SWE
							}
						}
					}
				}
				clr_global_flag = thirty_years_war_ongoing
				set_global_flag = thirty_years_war_ended
			}
			if = {
				limit = {
					country_exists = LIT
					country_exists = POL
				}
				POL = { set_cosmetic_tag = Poland_alone }
			}
		}
	}
	
	#ROOT is winner #FROM gets annexed - For civil wars on_civil_war_end is also fired
	on_annex = {
		effect = {
			if = {
				limit = {
					has_cosmetic_tag = Poland_alone
					FROM = {
						tag = LIT
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					ROOT = {
						NOT = { tag = UPS }
						owns_state = 555
					}
					UPS = { exists = no }
					NOT = { has_country_flag = take_UPS }
				}
				country_event = { id = RoF_NED.111 days = 2 }
			}
			if = {
				limit = {
					has_global_flag = thirty_years_war_ongoing
					OR = {
						AND = {
							FROM = { tag = SWE }
							OR = {
								tag = AUS
								is_in_faction_with = AUS
							}
						}
						AND = {
							FROM = { tag = AUS }
							OR = {
								tag = SWE
								is_in_faction_with = SWE
							}
						}
					}
				}
				clr_global_flag = thirty_years_war_ongoing
				set_global_flag = thirty_years_war_ended
			}
			if = {
				limit = {
					FROM = { has_country_flag = NUS_coc_inspired }
				}
				FROM = { 
					clr_country_flag = NUS_coc_inspired
					set_country_flag = NUS_coc_inspired_annexed
					add_to_variable = { NUS.NUS_patriotic_fervor = -1 }
					remove_from_array = {
						array = NUS.patriotic_fervor_array
						value = THIS
					}
				}
			}
		}
	}

	#ROOT = nation being puppeted, FROM = overlord
	on_puppet = {
		effect = {
			if = {
				limit = {
					has_global_flag = thirty_years_war_ongoing
					OR = {
						AND = {
							tag = SWE
							FROM = { 
								OR = {
									tag = AUS
									is_in_faction_with = AUS
								}
							}
						}
						AND = {
							tag = AUS
							FROM = { 
								OR = {
									tag = SWE
									is_in_faction_with = SWE
								}
							}
						}
					}
				}
				clr_global_flag = thirty_years_war_ongoing
				set_global_flag = thirty_years_war_ended
			}
		}
	}

	#ROOT is winner #FROM gets annexed
	on_civil_war_end = {
		effect = {
			country_event = { id = RoF_ENG.155 days = 2 }
			country_event = { id = RoF_ENG.156 days = 2 }
			country_event = { id = RoF_ENG.172 days = 2 }
		}
	}
	
	#ROOT is subject FROM is previous overlord
	on_subject_free = {
		effect = {
			clr_country_flag = crown_union_flag
			clr_country_flag = federal_state
			clr_country_flag = RoF_raise_autonomy
			clr_country_flag = RoF_lower_autonomy
			clr_country_flag = RoF_go_free
			clr_country_flag = RoF_annex_puppet
			if = {
				limit = { has_country_flag = colony_flag }
				set_country_flag = former_colony
				clr_country_flag = colony_flag
			}
		}
	}

	#ROOT is subject FROM is overlord
	on_subject_autonomy_level_change = {
		effect = {
			clr_country_flag = RoF_raise_autonomy
			clr_country_flag = RoF_lower_autonomy
		}
	}

	#ROOT is subject FROM is overlord
	on_subject_annexed = {
		effect = {
			clr_country_flag = crown_union_flag
			clr_country_flag = federal_state
			clr_country_flag = RoF_raise_autonomy
			clr_country_flag = RoF_lower_autonomy
			clr_country_flag = RoF_go_free
			clr_country_flag = RoF_annex_puppet
			if = {
				limit = { has_country_flag = colony_flag }
				set_country_flag = former_colony
				clr_country_flag = colony_flag
			}
			if = {
				limit = {
					FROM = { has_cosmetic_tag = Poland_alone }
					tag = LIT
				}
				FROM = { drop_cosmetic_tag = yes }
			}
		}
	}
	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = { state = 372 }
					FROM = { tag = PER }
					ROOT = { tag = TUR }
				}
				ROOT = {
					country_event = {
						id = RoF_TUR.164
					}
				}
			}
		}
	}
	#ROOT is the nation being liberated, FROM is the leader of the liberators.
	on_liberate = {
		effect = {
			if = {
				limit = {
					tag = LIT
					country_exists = POL
				}
				POL = { set_cosmetic_tag = Poland_alone }
			}
		}
	}
	#ROOT is free nation FROM is releaser.
	on_release_as_free = {
		effect = {
			if = {
				limit = {
					tag = LIT
					country_exists = POL
				}
				POL = { set_cosmetic_tag = Poland_alone }
			}
		}
	}
	#ROOT is the nation being released, FROM is the overlord.
	on_release_as_puppet = {
		effect = {
			if = {
				limit = {
					tag = LIT
					country_exists = POL
				}
				POL = { set_cosmetic_tag = Poland_alone }
			}
		}
	}

	on_monthly = {
		effect = {
			if = {
				limit = {
					has_variable = CoC_strength
				}
				check_CoC_strength_anger = yes
				check_CoC_effects_for_this = yes
			}
		}
	}
	on_monthly_WAU = {
		effect = {
			if = {
				limit = {
					has_global_flag = CoC_established
				}
				random_country = {
					limit = {
						NOT = { has_country_flag = CoC_present }
						any_neighbor_country = {
							has_variable = CoC_strength
						}
						capital_scope = {
							is_on_continent = europe
						}
					}
					country_event = { id = RoF.010 }
					log = "[This.GetName] has CoC at [GetDateText]"
				}
			}
		}
	}
}